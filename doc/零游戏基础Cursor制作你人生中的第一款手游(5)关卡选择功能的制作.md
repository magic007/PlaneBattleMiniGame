# 零游戏基础Cursor制作你人生中的第一款手游(5)关卡选择功能的制作



目前审核，微信审核应该通过了，提示**主管部门审核中**，有新的进展，等**主管部门已通过**，我们就可以备案了

![0.png](https://www.cctvcloud.cn/usr/uploads/2024/11/2831404117.png)

这个是微信的审核说明：

https://developers.weixin.qq.com/community/minigame/doc/000aaa768989c83430717f6596bc01



上次提交微信审核，需要截图十几个关卡图片， 我都是一关一关通过后截图，速度太慢了，如果失败了又从第一关开始，截图效率太低。这一章，我们实现一个游戏关卡选择功能，这样如果没通过需要再次审核，修改某一个场景背景，我就可以切换不同关卡截图

我们看下这一章的效果，点击当前关卡，弹出关卡选择

![Xnip2024-11-13_11-57-34.jpg](https://www.cctvcloud.cn/usr/uploads/2024/11/2203081215.jpg)



来看一下，我通过Cursor 不写代码，如何实现的

### 1.生成一张背景图

这里去百度https://image.baidu.com/  生成一张背景图即可，当然其他AI也行。我的提示文字：

> 我开发一款游戏，帮忙生成一个关卡选择界面，第一关到第十关，空中，雪地，悬崖，冰雪风格



### 2.让他帮忙生成一个关卡选择界面

> 点击当前关卡弹出一个关卡选择图片images/ka.jpeg盖住所有，有每行2个按钮，可以选择LevelManager下面的所有关卡，第一关，第二关

```
我来帮你实现一个关卡选择界面。首先，我们需要在 GameInfo 类中添加关卡选择的相关方法：
然后，在 Main 类中添加处理关卡选择的逻辑：
这段代码实现了以下功能：
点击"当前关卡"文本时，显示关卡选择界面
关卡选择界面使用 images/ka.jpeg 作为背景
每行显示两个关卡按钮
点击关卡按钮后，直接跳转到对应关卡
关卡选择界面会覆盖整个游戏画面
你需要确保：
images/ka.jpeg 图片存在于正确的路径
在微信开发者工具中正确配置图片路径
```

### 3.游戏没暂停

> 弹出关卡选择，需要暂停游戏

```
是的，在显示关卡选择界面时需要暂停游戏。我们可以在 Main 类中添加一个暂停标志，并在显示关卡选择界面时暂停游戏逻辑的更新。以下是修改建议：
然后在 GameInfo 类中，当显示关卡选择界面时暂停游戏：
这样修改后：
点击关卡文本显示关卡选择界面时，游戏会暂停
选择新关卡后，游戏会自动恢复
在暂停状态下，游戏逻辑不会更新，但画面仍然会渲染
你需要确保在游戏初始化时将 Main 的实例保存到 GameGlobal.main，这样 GameInfo 类才能访问到暂停方法。在 Main 类的构造函数中添加：
```

### 4.报错 Cannot read property 'find' of undefined

> 提示 Cannot read property 'find' of undefined

```
这个错误是因为在 touchEventHandler 方法中访问 this.levelButtons 时，它可能还未被定义。我们需要确保在显示关卡选择界面之前初始化 levelButtons 数组。
让我们修改 GameInfo 类：
主要修改：
在构造函数中初始化 levelButtons 数组
在 touchEventHandler 中添加对 this.levelButtons 的存在性检查
这样修改后应该能够解决 Cannot read property 'find' of undefined 的错误。
```

### 5.他默认按钮比较难看

> 第几关的按钮样式改为半透明，底部加入一个退出按钮，退出后游戏继续

```
好的，我来帮你修改关卡选择界面的按钮样式，并添加退出按钮。以下是修改后的代码：
主要修改：
将关卡按钮的背景色改为半透明的蓝色 rgba(0, 122, 255, 0.7)
在底部添加了一个半透明的红色退出按钮
在 touchEventHandler 中添加了对退出按钮的点击检测
点击退出按钮时，隐藏关卡选择界面并恢复游戏
```

### 6. 退出按钮体验差

> 有飞机掉下来时，点击退出后，不要立马开始，而是倒计时3秒后开始

```
好的，我们需要在点击退出按钮后添加一个3秒倒计时的功能。我们可以在 GameInfo 类中添加倒计时的显示，并在 Main 类中控制倒计时的逻辑。
首先，更新 GameInfo 类：
然后，更新 Main 类中的 resumeGame 方法：
这些修改实现了以下功能：
点击退出按钮后，显示3秒倒计时
倒计时显示在屏幕中央，带有半透明背景
倒计时结束后才恢复游戏
倒计时期间游戏保持暂停状态
这样，当玩家点击退出按钮后，会看到一个3秒的倒计时，倒计时结束后游戏才会继续。
```

##### 点击退出看效果

![Xnip2024-11-13_12-07-31.jpg](https://www.cctvcloud.cn/usr/uploads/2024/11/724349138.jpg)



项目源码同步更新：https://github.com/magic007/PlaneBattleMiniGame



这样就实现了，游戏关卡选择，点击不同关卡，就可以进入新关卡游戏，或者截图。  目前在审核期，后期我们把这个关卡功能，做成常见游戏产品模式，前面关卡没通过，后面关卡需要解锁才可以玩。